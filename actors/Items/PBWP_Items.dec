Actor ScientificPresent2
{
Radius 8
Height 5
Mass 1000000
Health 20
Damage 0
Speed 30
+NOBLOOD
+SHOOTABLE
+MISSILE
+DOOMBOUNCE
+BOUNCEONFLOORS
+BOUNCEONWALLS
+BOUNCEONCEILINGS
BounceFactor 0.5
+THRUSPECIES
+THRUGHOST
	States
	{
	Spawn:
		PRS2 A 0
		PRS2 A 0 A_Gravity
		PRS2 AAA 4
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("ScientificPresent2thing")
		Stop
	Splash:
		PRS2 A 1
		PRS2 A -1
		Stop
	}
}
ACTOR ScientificPresent2thing
{
	Health 15
	Radius 8
	Height 12
	//+MISSILE
	+SOLID
	+SHOOTABLE
	+NOBLOOD
	States
	{
		Spawn:
		PRS2 A -1
		stop
	Death:
		TNT1 AA 0 A_SpawnItemEx("Present2Junk1", 5, 0, 0, 2, random (2, 3), 10)
		TNT1 AA 0 A_SpawnItemEx("Present2Junk2", 5, 0, 0, 2, random (-3, -2), 10)
		TNT1 A 0 A_SpawnItemEx("Present2Junk3", 5, 0, 0, 3, random (1, 4), 10)
		TNT1 A 0 A_SpawnItemEx("Present2Junk4", 5, 0, 0, 1, random (-1, -4), 10)
		TNT1 AAA 0 A_SpawnItemEx("GoldAmmoShell", 5, 0, 0, 2, random (2, 3), 5)
		TNT1 AAA 0 A_SpawnItemEx("PyroAmmoShell", 5, 0, 0, 2, random (-2, 3), 5)
		TNT1 AAA 0 A_SpawnItemEx("CryoAmmoShell", 5, 0, 0, 2, random (2, -3), 5)
		TNT1 A 0 A_SpawnItemEx("FreezenadeAmmo", 5, 0, 0, 2, random (-2, -3), 5)
		TNT1 A 0 A_SpawnItemEx("FreezenadeAmmo", 5, 0, 0, 2, random (-1, -3), 4)
		TNT1 AA 0 A_SpawnItemEx("GAmmoRocket", 5, 0, 0, 2, random (-2, -2), 4)
		TNT1 A 0 A_SpawnItemEx("GAmmoRocket", 5, 0, 0, 2, random (-2, -4), 2)
		PRS2 F 100
		PRS2 FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF 1 A_FadeOut(0.01)
		Stop

	Splash:
		PRS2 A 1
		PRS2 A -1
		Stop
		}
	}

ACTOR Present2Junk1: XDeath1
{
	+CLIENTSIDEONLY
	+DONTSPLASH
	+DOOMBOUNCE
	BounceFactor 0.5
	Speed 14
	Gravity 0.8
	DeathSound "dsempty"
	SeeSound "dsempty"
	Decal None
	Scale 1.0
	States
	{
	Spawn:
		TNT1 A 0 A_JumpIf(waterlevel > 1, "Splash")
		PRS2 B 3
		Loop

	Death:
		PRS2 B 100
		PRS2 BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB 1 A_FadeOut(0.01)
		Stop
	Splash:
		PRS2 B 1
		PRS2 B -1
		Stop
	}
}


ACTOR Present2Junk2: Present2Junk1
{
	States
	{
	Spawn:
		TNT1 A 0 A_JumpIf(waterlevel > 1, "Splash")
		PRS2 C 3
		Loop

	Death:
		PRS2 C 100
		PRS2 CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC 1 A_FadeOut(0.01)
		Stop

	Splash:
		PRS2 C 1
		PRS2 C -1
		Stop
	}
}

ACTOR Present2Junk3: Present2Junk1
{
	States
	{
	Spawn:
		TNT1 A 0 A_JumpIf(waterlevel > 1, "Splash")
		PRS2 D 3
		Loop

	Death:
		PRS2 D 100
		PRS2 DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD 1 A_FadeOut(0.01)
		Stop

	Splash:
		PRS2 D 1
		PRS2 D -1
		Stop
	}
}

ACTOR Present2Junk4: Present2Junk1
{
	States
	{
	Spawn:
		TNT1 A 0 A_JumpIf(waterlevel > 1, "Splash")
		PRS2 E 3
		Loop

	Death:
		PRS2 E 100
		PRS2 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 A_FadeOut(0.01)
		Stop

	Splash:
		PRS2 E 1
		PRS2 E -1
		Stop
	}
}


Actor ScientificPresent1
{
Radius 8
Height 5
Mass 1000000
Health 20
Damage 0
Speed 30
+NOBLOOD
+SHOOTABLE
+MISSILE
+DOOMBOUNCE
+BOUNCEONFLOORS
+BOUNCEONWALLS
+BOUNCEONCEILINGS
BounceFactor 0.5
+THRUSPECIES
+THRUGHOST
	States
	{
	Spawn:
		PRS1 A 0
		PRS1 A 0 A_Gravity
		PRS1 AAA 4
		Loop
	Death:
		TNT1 A 0 A_SpawnItemEx("ScientificPresent1thing")
		Stop
	Splash:
		PRS1 A 1
		PRS1 A -1
		Stop
	}
}
ACTOR ScientificPresent1thing
{
	Health 15
	Radius 8
	Height 12
	//+MISSILE
	+SOLID
	+SHOOTABLE
	+NOBLOOD
	States
	{
		Spawn:
		PRS1 A -1
		stop
	Death:
		TNT1 AA 0 A_SpawnItemEx("Present1Junk1", 5, 0, 0, 2, random (2, 3), 10)
		TNT1 AA 0 A_SpawnItemEx("Present1Junk2", 5, 0, 0, 2, random (-3, -2), 10)
		TNT1 A 0 A_SpawnItemEx("Present1Junk3", 5, 0, 0, 3, random (1, 4), 10)
		TNT1 A 0 A_SpawnItemEx("Present1Junk4", 5, 0, 0, 1, random (-1, -4), 10)
		TNT1 A 0 A_SpawnItemEx("GoldAmmoShell", 5, 0, 0, 2, random (2, 3), 5)
		TNT1 A 0 A_SpawnItemEx("PyroAmmoShell", 5, 0, 0, 2, random (-2, 3), 5)
		TNT1 A 0 A_SpawnItemEx("CryoAmmoShell", 5, 0, 0, 2, random (2, -3), 5)
		TNT1 AA 0 A_SpawnItemEx("FreezenadeAmmo", 5, 0, 0, 2, random (-2, -3), 5)
		TNT1 AA 0 A_SpawnItemEx("FreezenadeAmmo", 5, 0, 0, 2, random (-1, -3), 4)
		TNT1 AA 0 A_SpawnItemEx("GAmmoRocket", 5, 0, 0, 2, random (-2, -2), 4)
		TNT1 AA 0 A_SpawnItemEx("GAmmoRocket", 5, 0, 0, 2, random (-2, -4), 2)
		PRS1 F 100
		PRS1 FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF 1 A_FadeOut(0.01)
		Stop

	Splash:
		PRS1 A 1
		PRS1 A -1
		Stop
		}
	}

ACTOR Present1Junk1: XDeath1
{
	+CLIENTSIDEONLY
	+DONTSPLASH
	+DOOMBOUNCE
	BounceFactor 0.5
	Speed 14
	Gravity 0.8
	DeathSound "dsempty"
	SeeSound "dsempty"
	Decal None
	Scale 1.0
	States
	{
	Spawn:
		TNT1 A 0 A_JumpIf(waterlevel > 1, "Splash")
		PRS1 B 3
		Loop

	Death:
		PRS1 B 100
		PRS1 BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB 1 A_FadeOut(0.01)
		Stop
	Splash:
		PRS1 B 1
		PRS1 B -1
		Stop
	}
}


ACTOR Present1Junk2: Present1Junk1
{
	States
	{
	Spawn:
		TNT1 A 0 A_JumpIf(waterlevel > 1, "Splash")
		PRS1 C 3
		Loop

	Death:
		PRS1 C 100
		PRS1 CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC 1 A_FadeOut(0.01)
		Stop

	Splash:
		PRS1 C 1
		PRS1 C -1
		Stop
	}
}

ACTOR Present1Junk3: Present1Junk1
{
	States
	{
	Spawn:
		TNT1 A 0 A_JumpIf(waterlevel > 1, "Splash")
		PRS1 D 3
		Loop

	Death:
		PRS1 D 100
		PRS1 DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD 1 A_FadeOut(0.01)
		Stop

	Splash:
		PRS1 D 1
		PRS1 D -1
		Stop
	}
}

ACTOR Present1Junk4: Present1Junk1
{
	States
	{
	Spawn:
		TNT1 A 0 A_JumpIf(waterlevel > 1, "Splash")
		PRS1 E 3
		Loop

	Death:
		PRS1 E 100
		PRS1 EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE 1 A_FadeOut(0.01)
		Stop

	Splash:
		PRS1 E 1
		PRS1 E -1
		Stop
	}
}

Actor UpgradeBot: SwitchableDecoration
{
    Radius 24
	Height 60
	MONSTER
   +SOLID
   +USESPECIAL
   -COUNTKILL
   +SHOOTABLE
   +LOOKALLAROUND
   -THRUACTORS
   +NOINFIGHTING
   +NOBLOOD
	MaxTargetRange 120
	Activation THINGSPEC_Activate | THINGSPEC_ThingTargets | THINGSPEC_NoDeathSpecial
	Mass 999999
	Speed 0
	Health 1000
   +FLOATBOB
   +NOGRAVITY
	DamageFactor "DestroyUpgradeStation", 9999.0
	Scale 1.0
    States
    {
    Spawn:
	    UABB AB 2 BRIGHT
		Loop
	Spawn2:
		UABB CD 2 BRIGHT
		Loop

	Active:
		UABB A 1 
		TNT1 A 0 A_JumpIfInTargetInventory("IsD4Weapon", 1, 1)
		Goto CantUpgrade
		UABB A 1
		TNT1 A 0 A_JumpIfInTargetInventory("D4MachinegunSelected", 1, "UpgradeMachinegun")
		UABB B 2
		Goto CantUpgrade

	UpgradeMachinegun:
		UABB A 1
		TNT1 A 0 A_JumpIfInTargetInventory("MachinegunUpgrade", 2, "MaxUpgrade")
		TNT1 A 0 A_GiveToTarget("MachinegunUpgrade", 1)
		TNT1 A 0 A_GiveToTarget("IsUpgradingWeapons", 1)
		UABB ABABABAB 2 BRIGHT
		Goto Spawn2

	CantUpgrade:
		TNT1 A 0
		TNT1 A 0 A_Print("This weapon can't be upgraded.", 2)
		TNT1 A 0 A_Noblocking
		TNT1 A 0 A_ChangeFlag("USESPECIAL", 0)
		TNT1 A 0 A_ChangeFlag("THRUACTORS", 1)
		TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
		TNT1 A 0 A_ChangeFlag("FLOATBOB", 0)
		TNT1 A 0 A_SpawnItemEx ("UpgradeBot", 0, 0, 0, 0, 0, 0, 0, SXF_NOCHECKPOSITION)
		TNT1 A 1
		TNT1 A -1
		Goto Spawn

	MaxUpgrade:
		TNT1 A 0
		TNT1 A 0 A_Print("This weapon already has all possible upgrades.", 2)
		TNT1 A 0 A_Noblocking
		TNT1 A 0 A_ChangeFlag("USESPECIAL", 0)
		TNT1 A 0 A_ChangeFlag("THRUACTORS", 1)
		TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
		TNT1 A 0 A_ChangeFlag("FLOATBOB", 0)
		TNT1 A 0 A_SpawnItem("UpgradeBot")
		TNT1 A 1
		TNT1 A -1
		Goto Spawn	

	Death:	
		UABB E 1
		TNT1 A 0 A_PlaySound("weapons/explode")
		TNT1 A 0 A_Scream
		TNT1 A 0 A_NoBlocking
		TNT1 AAAAAAAAA 0 A_CustomMissile ("ExplosionParticleHeavy", 50, 0, random (0, 360), 2, random (0, 180))
        TNT1 AAAAAAAAAAAAAAAAAA 0 A_CustomMissile ("ExplosionParticleHeavy", 50, 0, random (0, 360), 2, random (0, 360))
		TNT1 AAAAAAAAA 0 A_CustomMissile ("ExplosionParticleVeryFast", 50, 0, random (0, 360), 2, random (0, 360))
        TNT1 AAAAA 0 A_CustomMissile ("MediumExplosionFlames", 50, 0, random (0, 360), 2, random (0, 360))
        EXPL AAAAA 0 A_CustomMissile ("ExplosionSmokeFast22", 50, 0, random (0, 360), 2, random (0, 360))
		UABB E 1 A_FaceTarget
		TNT1 A 0 A_ChangeFlag("USESPECIAL", 0)
		TNT1 A 0 A_ChangeFlag("THRUACTORS", 1)
		TNT1 A 0 A_ChangeFlag("NOGRAVITY", 0)
		TNT1 A 0 A_ChangeFlag("FLOATBOB", 0)
		TNT1 A 0 ThrustThingZ(0,25,0,1)
		UABB E 8 A_Recoil(3)
		UABB F -1
		Stop	
	}
}

Actor PickD4UpgradeAttack: FastProjectile
{
	Radius 18
	Height 6
	DamageType DestroyUpgradeStation
	Projectile 
	+FORCEXYBILLBOARD
	+NOEXTREMEDEATH
	RenderStyle Add
	Alpha 0.6
    Damage (random(28,32))
    Speed 30
	SeeSound "none"
	DeathSound "none"
	Decal "none"
	States
	{
	Spawn:
		TNT1 A 1 BRIGHT
        TNT1 A 1
		Stop
	Death:
	XDEath:
			TNT1 A 0
			TNT1 A 0 A_CheckFloor("DeathOnGround")
		    PUFF A 0 A_PlaySound("player/cyborg/fist", 3)
			TNT1 A 0 A_SpawnItemEx ("PLOFT2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
			EXPL AAAAAA 0 A_CustomMissile ("MeleeSmoke", 0, 0, random (0, 360), 2, random (0, 360))
			TNT1 A 0 A_GiveToTarget("KickHasHit", 1)
			TNT1 A 0 Radius_Quake (2, 6, 0, 5, 0)//(intensity, duration, damrad, tremrad, tid)
			TNT1 A 10
		    Stop

	DeathOnGround:
			TNT1 A 0
		    PUFF A 0 A_PlaySound("player/cyborg/fist", 3)
			TNT1 A 0 A_SpawnItemEx ("PLOFT2",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION,0)
			EXPL AAAAAA 0 A_CustomMissile ("MeleeSmoke", 0, 0, random (0, 360), 2, random (0, 360))
			TNT1 A 0 Radius_Quake (2, 6, 0, 5, 0)//(intensity, duration, damrad, tremrad, tid)
			TNT1 A 0 A_Explode(10, 40, 0)
			TNT1 A 10
		    Stop
	}
}