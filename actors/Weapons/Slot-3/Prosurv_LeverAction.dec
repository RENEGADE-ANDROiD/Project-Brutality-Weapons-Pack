Actor RespectLeverAction: Inventory
{
Inventory.maxamount 1
}

Actor LeverActionChamberEmpty: Inventory
{
Inventory.maxamount 1
}

Actor LeverActionHasUnloaded: Inventory
{
Inventory.maxamount 1
}

Actor LeverActionWasEmpty: Inventory
{
Inventory.maxamount 1
}

Actor PumpLeverAction: Inventory
{
Inventory.maxamount 1
}

Actor LeverActionMarlin: Inventory
{
Inventory.maxamount 1
}

Actor JustFiredLeverAction: Inventory
{
Inventory.maxamount 200
}

ACTOR Prosurv_LeverAction : PBWP_Weapon
{
	Weapon.BobRangeX 0.3
	Weapon.BobRangeY 0.5
	Weapon.BobStyle InverseSmooth
	Weapon.BobSpeed 2.4
	Game Doom
	Weapon.SelectionOrder 1300
	Weapon.AmmoUse1 0
	Weapon.AmmoUse2 0
	Weapon.AmmoGive1 22
	Weapon.AmmoGive2 11
	+FLOORCLIP
	+DONTGIB
	Scale 0.4
	Weapon.AmmoType1 "PB_LowCalMag"
	Weapon.AmmoType2 "LeverActionAmmo"
	Inventory.PickupMessage "UAC M1893 Mod 0 Lever Action (Slot 4)"
	Inventory.PickupSound "weapons/leveraction/rechamber"
	Inventory.Icon "AUSCA0"
    Inventory.AltHUDIcon "AUSCA0"
	Damagetype "Shotgun"
	Inventory.Amount 1
	Inventory.MaxAmount 3
	Obituary "%k Drew a Bead On %o with a Lever Action"
    Weapon.SlotNumber 3
	Weapon.SlotPriority 0
	Weapon.SelectionOrder 1300
	AttackSound "None"
	Tag "UAC M1893 Mod 0 Lever Action"
	Inventory.AltHudIcon "LVR4E0"
	+WEAPON.NOALERT
	+WEAPON.NOAUTOAIM
	+WEAPON.NOAUTOFIRE
	PB_WeaponBase.UnloaderToken "PBLeverActionHasUnloaded"
	PB_WeaponBase.RespectItem "RespectLeverAction"
	States
	{
		// CUSTOM MELEE ANIMATION, JUST UNCOMMENT THIS CODE AND ADD YOUR ANIMATION
		/*QuickMelee:
				"####" A 0 {
					A_StopSound(CHAN_WEAPON);
					A_StopSound(CHAN_VOICE);
					A_StopSound(CHAN_6);
					A_StopSound(CHAN_7);
				}
				TNT1 A 0 A_JumpIfInventory("CantDoAction",1,"FailOverlay")
				TNT1 A 0 A_JumpIfHealthLower(0, "FailOverlay")
				TNT1 A 0 A_JumpIf(!CustomMelee, "Super::GoMeleeInstead")
				TNT1 A 0 {
					A_ClearOverlays(-10,65);
					A_Gunflash("Null");
				}
			"####" AAA 0 PB_Execute()
		GoMeleeInstead:
		TNT1 A 0 {
				A_Overlay(PSP_FLASH, "FlashPunching");
				A_TakeInventory("Zoomed",1);
				A_ZoomFactor(1.0);
				A_PlaySound("AXSWING");
				A_TakeInventory("ADSmode",1);
				A_SetRoll(0);
				A_Overlay(-10, "FirstPersonLegsStand");
			}
		INSERT ANIMATION HERE
		TNT1 A 0 PB_CheckBarrelIdle1()
		Goto Ready*/

		Steady:
			TNT1 A 1
			Goto Ready
			
		Ready:
			TNT1 A 0 {	
				A_Takeinventory("Unloading",1);
				A_Takeinventory("Zoomed",1);
				A_Takeinventory("ADSmode",1);
				A_ZoomFactor(1.0);
			}
			LVRA EDCB 0  
			LVR4 A 0
			LVRA AA 0 
			TNT1 A 0 PB_RespectIfNeeded()
		WeaponRespect:
			TNT1 A 0 {
				A_SetCrosshair(5);
				A_Giveinventory("PB_LockScreenTilt",1);
                A_Takeinventory("Zoomed",1);
				A_Takeinventory("ADSmode",1);
			}
			TNT1 AAAAAA 1 {
				A_SetRoll(roll-0.3,SPF_INTERPOLATE);
				A_DoPBWeaponAction;
			}
			TNT1 A 0 A_PlaysoundEx("weapons/leveraction/inspect", "Auto")
			LVRA ZYXWV 1 {
				A_SetRoll(roll+0.3,SPF_INTERPOLATE);
				A_DoPBWeaponAction;
			}
			TNT1 A 0 A_PlaysoundEx("weapons/leveraction/flip", "Auto")
			LVR4 F 1 A_SetRoll(roll+0.3,SPF_INTERPOLATE)
			LVRA FGIKM 1 A_SetRoll(roll+0.3,SPF_INTERPOLATE)
			TNT1 A 0 A_PlaysoundEx("weapons/leveraction/rechamber", "Auto")
			LVRA NNNNNOPQR 1 
			LVRA SUT 1 A_SetRoll(roll-0.3,SPF_INTERPOLATE)
			LVR4 G 1 A_SetRoll(roll-0.3,SPF_INTERPOLATE)
			LVRA AA 1 A_SetRoll(roll-0.3,SPF_INTERPOLATE)
			LVR2 MNOPQQ 1 {
				A_SetRoll(roll-1.0,SPF_INTERPOLATE);
				A_DoPBWeaponAction;
			}
			TNT1 A 0 A_PlaySoundEx("weapons/leveraction/openchamber","Auto")
			LVR2 RSTUVVVV 1 {
				A_SetRoll(roll+1.0,SPF_INTERPOLATE);
				A_DoPBWeaponAction;
			}
			LVR2 V 3 A_DoPBWeaponAction
			LVR3 AB 1 A_DoPBWeaponAction
			LVR3 C 1 { 
				A_PlaySoundEx("insertshell","Auto");
				A_SetPitch(pitch-0.2,SPF_INTERPOLATE);
				A_SetAngle(angle+0.2, SPF_INTERPOLATE);
				A_SetRoll(roll-0.4,SPF_INTERPOLATE);
				A_DoPBWeaponAction;
			}
			LVR3 D 1 {
				A_SetPitch(pitch+0.2,SPF_INTERPOLATE);
				A_SetAngle(angle-0.2, SPF_INTERPOLATE);
				A_SetRoll(roll+0.4,SPF_INTERPOLATE);
				A_DoPBWeaponAction;
			}
			LVR3 EFG 1 A_DoPBWeaponAction
			LVR2 V 5 A_DoPBWeaponAction
			TNT1 A 0 A_PlaySoundEx("weapons/leveraction/openchamber","Auto")
			LVR2 VUTSRQ 1 {
				A_DoPBWeaponAction;
				A_SetRoll(roll-1.0,SPF_INTERPOLATE);
			}
			LVR2 PONM 1 {
				A_DoPBWeaponAction;
				A_SetRoll(roll+1.0,SPF_INTERPOLATE);
			}
			LVRA AA 1 {
				A_DoPBWeaponAction;
				A_SetRoll(roll+1.0,SPF_INTERPOLATE);
			}
			TNT1 A 0 A_Takeinventory("PB_LockScreenTilt",1)
			Goto Ready3
		SelectAnimation:
			TNT1 A 0 A_PlaySoundEx("weapons/leveraction/inspect", "Auto")
			TNT1 A 0 {
				A_Takeinventory("Zoomed",1);
				A_Takeinventory("ADSmode",1);
			}
			LVRA EDCB 1  
			LVR4 A 1
			LVRA AA 1
            goto Ready3  

		Ready3:
		TNT1 A 0 A_JumpIfInventory("LeverActionChamberEmpty", 1, "Pump")
		TNT1 A 0 A_JumpIfInventory("Zoomed", 1, "Ready2")
		TNT1 A 0 A_JumpIfInventory("ADSMode", 1, "Ready2")
			TNT1 A 0 {
				A_ClearOverlays(10,11);
				A_SetRoll(0);
				A_SetCrosshair(76);
				A_TakeInventory("PB_LockScreenTilt",1);
			}
		ReadyToFire:
		TNT1 A 0 A_JumpIfInventory("LeverActionChamberEmpty", 1, "Pump")
		TNT1 A 0 A_JumpIfInventory("Zoomed", 1, "ReadyToFire2")
		TNT1 A 0 A_JumpIfInventory("ADSMode", 1, "ReadyToFire2")
			LVRA A 1 {
					if (CountInv("PumpLeverAction") == 1 && CountInv("LeverActionAmmo") >= 1) {return state("Pump");}
					return A_DoPBWeaponAction(WRF_ALLOWRELOAD, CheckUnloaded("LeverActionHasUnloaded"));
					// This token is given upon picking up the magazine upgrade.					
					if (PressingFire() && PressingAltfire() && CountInv("LeverActionAmmo") > 0){
							return state("Fire");
					}
					if (PressingFire() && CountInv("LeverActionAmmo") > 0){
							return state("Fire");
					}
					return A_DoPBWeaponAction(WRF_ALLOWRELOAD, CheckUnloaded("LeverActionHasUnloaded"));	 
				}
			Loop
		Ready2:
		TNT1 A 0 A_JumpIfInventory("LeverActionChamberEmpty", 1, "Pump2")
		LVR3 Q 1 {
			//Updated code for far superior smooth gameplay
			if(GetCvar("pb_toggle_aim_hold")) {
				if(!PressingAltfire() || JustReleased(BT_ALTATTACK)){
					return state("Zoomout");
				}
		
				if (PressingFire() && PressingAltfire() && CountInv("LeverActionAmmo") > 0){
						return state("Fire2");
				}
				return A_DoPBWeaponAction(WRF_ALLOWRELOAD|WRF_NOFIRE);
			}
			else {
				if (PressingFire() && CountInv("LeverActionAmmo") > 0){
					return state("Fire2");
				}
				return A_DoPBWeaponAction(WRF_ALLOWRELOAD);
			}
			return state("");
		}
		Loop
			
		WeaponSpecial:
			TNT1 A 0 PB_CheckBarrelIdle1()
			TNT1 A 0 {
				A_Takeinventory("GoWeaponSpecialAbility",1);
				A_GiveInventory("PB_LockScreenTilt",1);
				A_SetCrosshair(76);
			A_ClearOverlays(10,11);
			}
			TNT1 A 0 A_JumpIfInventory("LeverActionMarlin",1,"Normal")
			TNT1 A 0 A_Print(".444 Marlin Caliber Mode")
			TNT1 A 0 A_GiveInventory("LeverActionMarlin", 1)
			Goto ChangingCartridge
			
		Normal:
			TNT1 A 0 A_Takeinventory("GoWeaponSpecialAbility",1)
			TNT1 A 0 A_Print(".357 Revolver Caliber Mode")
			TNT1 A 0 A_TakeInventory("LeverActionMarlin", 1)
			Goto ChangingCartridge
			
		ChangingCartridge:
			LVR2 MNOP 1 A_SetRoll(roll+1.0,SPF_INTERPOLATE)
			TNT1 A 0 A_PlaySoundEx("weapons/leveraction/openchamber","Auto")
			LVR2 QQ 1 A_SetRoll(roll-2.0,SPF_INTERPOLATE)
			LVR2 RSTUVV 1 A_SetRoll(roll-0.6,SPF_INTERPOLATE)
			TNT1 A 0 A_PlaySound("weapons/smg_magfly1")
			LVR3 AB 1 A_SetRoll(roll-0.5,SPF_INTERPOLATE)
			TNT1 A 0 A_PlaySound("weapons/leveraction/loadshell","Auto")
			LVR3 CDEFG 1 A_SetRoll(roll-0.2,SPF_INTERPOLATE)
			Goto NormalReload
		
		Deselect:
			TNT1 A 0 PB_CheckBarrelPlace1()
			TNT1 A 0 {
				A_SetRoll(0);
				A_SetCrosshair(54);
				A_TakeInventory("PB_LockScreenTilt",1);
				A_ClearOverlays(10,11);
			}
			TNT1 A 0 {	
				A_Takeinventory("Unloading",1);
				A_Takeinventory("Zoomed",1);
				A_Takeinventory("ADSmode",1);
				A_ZoomFactor(1.0);
			}
			LVRA AA 1 
			LVR4 A 1
			LVRA BCDE 1  
			TNT1 AAAAAAAAAAAAAAAAAA 0 A_Lower
			Wait

		Select:
			TNT1 A 0 {
				A_SetRoll(0);
				A_SetCrosshair(76);
				A_TakeInventory("PB_LockScreenTilt",1);
				A_ClearOverlays(10,11);
                A_Takeinventory("Unloading",1);
			}
			TNT1 A 0 {
				A_Takeinventory("Zoomed",1);
				A_Takeinventory("ADSmode",1);
			}
			Goto SelectFirstPersonLegs
			
		SelectContinue:
			TNT1 AAAAAAAAAAAAAAAAAA 0 A_Raise
			TNT1 AAAAAAAA 1 A_Raise
			Wait
		
		Fire:
			TNT1 A 0 PB_CheckBarrelThrow1()
            TNT1 A 0 A_JumpIfInventory("LeverActionAmmo",1,1)
			Goto Reload
			TNT1 A 0 A_JumpIfInventory("Zoomed",1,"Fire2")
			TNT1 A 0 A_JumpIfInventory("ADSMode",1,"Fire2")
			TNT1 A 0 {
				A_SetRoll(0);
				A_SetCrosshair(76);
				A_TakeInventory("PB_LockScreenTilt",1);
				A_ClearOverlays(10,11);
			}
			TNT1 A 0 A_JumpIfInventory("LeverActionWasEmpty", 1, "Pump")
			TNT1 A 0 A_JumpIfInventory("LeverActionChamberEmpty", 1, "Pump")
			TNT1 A 0 
			TNT1 A 0 A_GiveInventory ("LeverActionChamberEmpty",1)
			LVR2 F 1 BRIGHT {
				if(GetCvar("PB_alttracer") >=1) {
				A_RailAttack(0, 0, 0, none,none, RGF_SILENT|RGF_NOPIERCING|RGF_EXPLICITANGLE, 0, none,0.1,0.1,700,0,1,1.0,"Tracer_Trail",-6,0,0);
				
				if (CountInv("LeverActionMarlin") == 1) {
					PB_FireBullets("PB_444Marlin",1, 0, 0, 0, 0);
					//A_StartSound("weapons/rifle/sniperfire", 11, CHANF_DEFAULT, 1.0);
					A_StartSound("weapons/leveraction/magfire", 11, CHANF_DEFAULT, 1.0);
					PB_DynamicTail("sniper", "sniper");
					PB_LowAmmoSoundWarning("revolver");
					PB_GunSmoke(0,0,0);
				}
			else { 
				PB_FireBullets("PB_357Magnum",1, 0, 0, 0, 0);
				A_PlaySoundeX("weapons/leveraction/fire", "Weapon");
				PB_LowAmmoSoundWarning;
				PB_GunSmoke(0,0,0);
				}
				}
			else {
			
				if (CountInv("LeverActionMarlin") == 1) {
					PB_FireBullets("PB_444Marlin",1, 0, 0, 0, 0);
					//A_StartSound("weapons/rifle/sniperfire", 11, CHANF_DEFAULT, 1.0);
					A_StartSound("weapons/leveraction/magfire", 11, CHANF_DEFAULT, 1.0);
					PB_DynamicTail("sniper", "sniper");
					PB_LowAmmoSoundWarning("revolver");
					PB_GunSmoke(0,0,0);
				}
			else { 
				PB_FireBullets("PB_357Magnum",1, 0, 0, 0, 0);
				A_PlaySoundeX("weapons/leveraction/fire", "Weapon");
				PB_LowAmmoSoundWarning;
				PB_GunSmoke(0,0,0);
				}
				}
				A_Takeinventory("LeverActionAmmo",1);
				A_AlertMonsters;
				PB_GunSmoke(0,0,0);
				A_FireCustomMissile("ShakeYourAssDouble", 0, 0, 0, 0);
				A_FireCustomMissile("YellowFlareSpawn",0,0,0,0);
				A_Giveinventory("JustFiredLeverAction",20);
				A_GunFlash;
				A_ZoomFactor(0.98);
				PB_WeaponRecoil(-1.83,+0.75);
				}
			LVR2 G 1 BRIGHT {
				A_ZoomFactor(0.99);
				PB_WeaponRecoil(-1.83,+0.75);
			}
			LVR2 H 1 {
				A_ZoomFactor(1.0);
				A_FireCustomMissile("EmptyBrassPistol",0,0,4,-8);
			}
			LVR2 IJKL 1 
			LVRA A 1 
			TNT1 A 0 {
			A_Takeinventory("Zoomed",1);
			A_Takeinventory("ADSmode",1);
			}
			Goto Pump
			
		Fire2:
			TNT1 A 0 A_JumpIfInventory("LeverActionAmmo", 1, 1)
			Goto Reload
			TNT1 A 0
			TNT1 A 0 {
				A_SetRoll(0);
				A_SetCrosshair(5);
				A_TakeInventory("PB_LockScreenTilt",1);
				A_ClearOverlays(10,11);
			}
			TNT1 A 0 A_JumpIfInventory("LeverActionAmmo",1,1)
			Goto Reload
			TNT1 A 0 A_JumpIfInventory("LeverActionWasEmpty", 1, "Pump")
			TNT1 A 0 A_JumpIfInventory("LeverActionChamberEmpty", 1, "Pump")
			TNT1 A 0 A_GiveInventory ("LeverActionChamberEmpty",1)
			LVR3 R 1 BRIGHT {
				if(GetCvar("PB_alttracer") >=1) {
				A_RailAttack(0, 0, 0, none,none, RGF_SILENT|RGF_NOPIERCING|RGF_EXPLICITANGLE, 0, none,0.1,0.1,700,0,1,1.0,"Tracer_Trail",-6,0,0);
				if (CountInv("LeverActionMarlin") == 1) {
					PB_FireBullets("PB_444Marlin",1, 0, 0, 0, 0);
					//A_StartSound("weapons/rifle/sniperfire", 11, CHANF_DEFAULT, 1.0);
					A_StartSound("weapons/leveraction/magfire", 11, CHANF_DEFAULT, 1.0);
					PB_DynamicTail("sniper", "sniper");
					PB_LowAmmoSoundWarning("revolver");
					PB_GunSmoke(0,0,0);
				}
			else { 
				PB_FireBullets("PB_357Magnum",1, 0, 0, 0, 0);
				A_PlaySoundeX("weapons/leveraction/fire", "Weapon");
				PB_LowAmmoSoundWarning;
				PB_GunSmoke(0,0,0);
				}
			}
			else {
				
				if (CountInv("LeverActionMarlin") == 1) {
					PB_FireBullets("PB_444Marlin",1, 0, 0, 0, 0);
					//A_StartSound("weapons/rifle/sniperfire", 11, CHANF_DEFAULT, 1.0);
					A_StartSound("weapons/leveraction/magfire", 11, CHANF_DEFAULT, 1.0);
					PB_DynamicTail("sniper", "sniper");
					PB_LowAmmoSoundWarning("revolver");
					PB_GunSmoke(0,0,0);
				}
			else { 
				PB_FireBullets("PB_357Magnum",1, 0, 0, 0, 0);
				A_PlaySoundeX("weapons/leveraction/fire", "Weapon");
				PB_LowAmmoSoundWarning;
				PB_GunSmoke(0,0,0);
				}
				}
				A_Takeinventory("LeverActionAmmo",1);
				A_AlertMonsters;
				PB_GunSmoke(0,0,0);
				A_FireCustomMissile("ShakeYourAssDouble", 0, 0, 0, 0);
				A_FireCustomMissile("YellowFlareSpawn",0,0,0,0);
				A_Giveinventory("JustFiredLeverAction",20);
				A_GunFlash;
				A_ZoomFactor(1.48);
				PB_WeaponRecoil(-1.75,+0.50);
			}
			LVR3 S 1 BRIGHT {
				A_ZoomFactor(1.49);
				PB_WeaponRecoil(-1.75,+0.50);
			}
			LVR3 TU 1 
			LVR3 VWX 1 
			TNT1 A 0 {
			//Updated code for far superior smooth gameplay
			if(GetCvar("pb_toggle_aim_hold")) {
				if(!PressingAltfire() || JustReleased(BT_ALTATTACK)){
					return state("Pump");
				}
		
				if (PressingFire() && PressingAltfire() && CountInv("LeverActionAmmo") > 0){
						return state("Pump2");
				}
				
				
				return A_DoPBWeaponAction(WRF_ALLOWRELOAD|WRF_NOFIRE);
				
			}
			else {
				if (PressingFire() && CountInv("LeverActionAmmo") > 0){
					return state("Pump2");
				}
				return A_DoPBWeaponAction(WRF_ALLOWRELOAD);
			}
			return state("");
		}
			Goto Pump2
		
		AltFire:
			TNT1 A 0 PB_CheckBarrelPlace1()
			TNT1 A 0 {
				A_SetRoll(0);
				A_SetCrosshair(76);
				A_TakeInventory("PB_LockScreenTilt",1);
				A_ClearOverlays(10,11);
			}
			TNT1 A 0 A_StartSound("IronSights", 0)
			TNT1 A 0 A_JumpIfInventory("Zoomed",1,"Zoomout")
			TNT1 A 0 A_ZoomFactor(1.5)
			LVR3 MNOP 1
			TNT1 A 0 {
			A_Giveinventory("Zoomed",1);
			A_Giveinventory("ADSmode",1);
			A_SetCrosshair(5);
			A_WeaponReady(WRF_NOSECONDARY);
			}
			Goto Ready2
			
		Zoomout:
			TNT1 A 0 {	
				A_SetCrosshair(76);
				A_ZoomFactor(1.0);
				}
			LVR3 PONM 1
			TNT1 A 0 {	
				A_Takeinventory("Zoomed",1);
				A_Takeinventory("ADSmode",1);
				}
			TNT1 A 0 A_WeaponReady(WRF_NOSECONDARY)
			TNT1 A 0 A_JumpIfInventory ("LeverActionChamberEmpty", 1, "Pump")
			Goto Ready3
			
		Pump:
			TNT1 A 0 {
			A_PlaysoundEx("weapons/leveraction/flip", "Auto");
			A_ZoomFactor(1.0);
			A_Giveinventory("PB_LockScreenTilt",1);
			A_TakeInventory("Zoomed",1);
			A_TakeInventory("ADSMode",1);
			A_SetCrosshair(5);
			A_PlaySoundEx("Ironsights", "Auto");
			}
			LVR4 F 1 A_SetRoll(roll+0.3,SPF_INTERPOLATE)
			LVRA FGIKM 1 A_SetRoll(roll+0.3,SPF_INTERPOLATE)
			TNT1 A 0 A_PlaysoundEx("weapons/leveraction/rechamber", "Auto")
			LVRA NNNNNOPQR 1 
			TNT1 A 0 A_FireCustomMissile("EmptyBrassPistol",0,0,-2,-18)
			LVRA SUT 1 A_SetRoll(roll-0.3,SPF_INTERPOLATE)
			LVR4 G 1 A_SetRoll(roll-0.3,SPF_INTERPOLATE)
			LVRA AA 1 A_SetRoll(roll-0.3,SPF_INTERPOLATE)
			TNT1 A 0 {
				A_TakeInventory("PumpLeverAction", 1);
				A_TakeInventory ("LeverActionChamberEmpty",1);
			}
			TNT1 A 0 A_refire
			Goto Ready3
		
	Pump2:
		TNT1 A 0 {
			A_ZoomFactor(1.5);
			A_Giveinventory("PB_LockScreenTilt",1);
			A_SetCrosshair(5);
			}
	    TNT1 A 0 A_PlaySoundEx("weapons/leveraction/rechamber", "Auto")
		LVR4 ABCD 1
		TNT1 A 0 A_FireCustomMissile("EmptyBrassPistol",0,0,4,-7)	 
		LVR4 DDDDCBA 1 
		LVR4 A 2 
		TNT1 A 0 A_TakeInventory ("LeverActionChamberEmpty",1)
		TNT1 A 0 {
		if(GetCvar("pb_toggle_aim_hold")) {
			if(JustReleased(BT_ALTATTACK)){
				return state("Zoomout");
			}
	
			if (JustPressed(BT_ATTACK) && PressingAltfire()){
					return state("Fire2");
			}
		}
		else {
			if(PressingAltfire()){
				return state("Zoomout");
			}
			
			if (JustPressed(BT_ATTACK)){
					return state("Fire2");
			}
			A_Refire("Fire2");
		}
		return A_DoPBWeaponAction(WRF_ALLOWRELOAD|WRF_NOFIRE);
	}
		TNT1 A 0 A_JumpIfInventory("LeverActionAmmo",1,1)
		Goto Reload
		TNT1 A 0
		 Goto Ready2
		
		Reload:
			TNT1 A 0 PB_CheckBarrelIdle1()
			TNT1 A 0 {
			A_Takeinventory("Zoomed",1);
			A_Takeinventory("ADSmode",1);
			A_ZoomFactor(1.0);
			A_Giveinventory("PB_LockScreenTilt",1);
			A_SetCrosshair(5);
			A_ClearOverlays(10,11);
			}
			TNT1 A 0 A_JumpIfInventory("LeverActionAmmo",11, "Ready3")
			TNT1 A 0 A_JumpIfInventory("PB_LowCalMag",1, "ReloadAnimation")
			TNT1 A 0 A_PlaySoundEx("weapons/leveraction/inspect", "Auto")
			Goto Ready3
		ReloadAnimation:
			LVR2 MNOP 1 A_SetRoll(roll+1.0,SPF_INTERPOLATE)
			TNT1 A 0 A_PlaySoundEx("weapons/leveraction/openchamber","Auto")
			LVR2 QQ 1 A_SetRoll(roll-2.0,SPF_INTERPOLATE)
			LVR2 RSTUVV 1 A_SetRoll(roll-0.6,SPF_INTERPOLATE)
		NormalReload:
			TNT1 A 0 A_JumpIf(CountInv("PB_LowCalMag") == 0,"ReloadFinished")
			TNT1 A 0 A_JumpIfInventory("LeverActionAmmo",11,"ReloadFinished")
			LVR2 V 2 A_DoPBWeaponAction(WRF_NOBOB)
			LVR3 AB 1 A_DoPBWeaponAction(WRF_NOBOB)
			LVR3 C 1 { 
				A_PlaySoundEx("weapons/leveraction/loadshell","Auto");
				A_Giveinventory("LeverActionAmmo",1);
				if (CountInv("LeverActionMarlin") == 1) {
					A_Takeinventory("PB_LowCalMag",3,TIF_NOTAKEINFINITE);
				}
			else { 
				A_Takeinventory("PB_LowCalMag",2,TIF_NOTAKEINFINITE);
				}
				A_Takeinventory("LeverActionWasEmpty", 1);
				A_SetPitch(pitch-0.2,SPF_INTERPOLATE);
				A_SetAngle(angle+0.2, SPF_INTERPOLATE);
				A_SetRoll(roll-0.4,SPF_INTERPOLATE);
			}
			LVR3 D 1 {
				A_DoPBWeaponAction(WRF_NOBOB);
				A_SetPitch(pitch+0.2,SPF_INTERPOLATE);
				A_SetAngle(angle-0.2, SPF_INTERPOLATE);
				A_SetRoll(roll+0.4,SPF_INTERPOLATE);
			}
			LVR3 EFG 1 A_DoPBWeaponAction(WRF_NOBOB)
			LVR2 V 1  A_DoPBWeaponAction(WRF_NOBOB)
			Loop
		ReloadFinished:
			TNT1 A 0 {
				A_Takeinventory("PB_LockScreenTilt",1);
				A_PlaySoundEx("weapons/leveraction/openchamber","Auto");
			}
			LVR2 VVVV 1 {
				A_DoPBWeaponAction(WRF_NOBOB);
			}
			LVR2 VUTSRQ 1 {
				A_DoPBWeaponAction(WRF_NOBOB);
				A_SetRoll(roll+0.6,SPF_INTERPOLATE);
			}
			LVR2 PONM 1 A_DoPBWeaponAction(WRF_NOBOB)
			Goto Ready3
		
		Unload:
			TNT1 A 0 {
				A_Giveinventory("PB_LockScreenTilt",1);
				A_PlaysoundEx("weapons/leveraction/inspect", "Auto");
				A_Takeinventory("Unloading",1);
				A_GiveInventory("LeverActionWasEmpty", 1);
				A_ClearOverlays(10,11);
			}
			TNT1 A 0 A_JumpIfInventory("LeverActionAmmo",1,1)
			Goto Ready3
			LVR2 MNOPQ 1 A_DoPBWeaponAction
			TNT1 A 0 A_JumpIfInventory("GoFatality",1,"Steady")
		RemoveBullets:
			TNT1 A 0 A_JumpIfInventory("LeverActionAmmo",1,1)
			Goto FinishUnload
			TNT1 A 0 {
				A_Takeinventory("LeverActionAmmo",1);
				if (CountInv("LeverActionMarlin") == 1) {
					A_Giveinventory("PB_LowCalMag",3);
				}
			else { 
				A_Giveinventory("PB_LowCalMag",2);
				}
				A_PlaysoundEx("weapons/leveraction/rechamber", "Weapon");
			}
			LVR2 POPQQQQQ 1 A_DoPBWeaponAction
			Loop
		
		FinishUnload:
			LVR2 QPONM 1 A_DoPBWeaponAction
			TNT1 A 0 A_Giveinventory("LeverActionWasEmpty",1)
			TNT1 A 0 A_Takeinventory("Unloading",1)
			Goto ReadyToFire
	
		Spawn:
			LVR4 E 10 
			LOOP
			
		FlashPunching:
			LVRA VWXYZZZ 1 A_DoPBWeaponAction(WRF_ALLOWRELOAD)
			LVRA ZZZYXWV 1
			Stop

		FlashKicking:
			LVR2 ABCDE 1 A_DoPBWeaponAction(WRF_ALLOWRELOAD)
			LVR2 E 4
			LVR2 EDCBA 1
			LVRA A 1
			Goto ReadyToFire
		
		FlashAirKicking:
			LVR2 ABCDE 1 A_DoPBWeaponAction(WRF_ALLOWRELOAD)
			LVR2 E 5
			LVR2 EDCBA 1
			LVRA A 1
			Goto ReadyToFire
		
		FlashSlideKicking:
			LVRA VWXYZZZZZZZZZZZZZZZZZZ 1 A_DoPBWeaponAction(WRF_ALLOWRELOAD)
			Goto ReadyToFire

		FlashSlideKickingStop:
			LVRA ZYXWVAA 1 A_DoPBWeaponAction
			Goto ReadyToFire

	}
}

ACTOR LeverActionAmmo : PB_Ammo
{
   Inventory.Amount 0
   Inventory.MaxAmount 11
   Ammo.BackpackAmount 0
   Ammo.BackpackMaxAmount 11
   +Inventory.IgnoreSkill
   Inventory.Icon "AUSCA0"
}